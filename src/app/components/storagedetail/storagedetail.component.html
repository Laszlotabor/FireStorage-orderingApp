<div class="storage-container" *ngIf="storage$ | async as storage; else loading">
  <!-- Header -->
  <div class="header">
    <h2>{{ storage.name }}</h2>
    <h4>createdBy: <span>{{ storage.creatorId }}</span></h4>
  </div>

  <!-- Add New Item -->
  <div class="add-item-card">
    <label for="newItemInput">Add New Item</label>
    <div class="add-item-input-group">
      <input
        id="newItemInput"
        type="text"
        [(ngModel)]="newItemName"
        placeholder="Enter item name"
        (keydown.enter)="addItem()"  
      />
      <button (click)="addItem()">Add</button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="storage-main">
    <!-- Items List -->
    <div class="card-section">
      <h3>Items in Storage</h3>
      <ul *ngIf="storage.items.length > 0; else noItems" class="item-list">
        <li *ngFor="let item of storage.items" class="item-line">
          <span class="item-name">{{ item.name }}</span>

          <div class="item-actions">
            <button
              class="btn btn-outline-danger btn-xs"
              (click)="deleteItem(item.id!)"
            >
              Del
            </button>

            <div class="qty-group">
              <input
                type="number"
                min="1"
                [(ngModel)]="quantities[item.id!]"
                placeholder="Q:"
              />
            </div>

            <button
              class="btn btn-outline-primary btn-xs"
              (click)="placeOrder(item.id!)"
              [disabled]="!quantities[item.id!] || quantities[item.id!] <= 0"
            >
              Order
            </button>
          </div>
        </li>
      </ul>

      <ng-template #noItems>
        <p class="empty">No items available.</p>
      </ng-template>
    </div>

    <!-- Orders List -->
    <div class="card-section">
      <h3>Orders</h3>
      <ul class="orders-list">
        <ng-container *ngFor="let item of storage.items">
          <li *ngIf="item.orderedYet">
            {{ item.name }} (Qty Ordered: {{ item.quantityOrdered }})
            <button
              class="btn btn-outline-danger btn-xs"
              (click)="removeOrder(item.id!)"
            >
              Remove
            </button>
          </li>
        </ng-container>
      </ul>
    </div>
  </div>

  <button (click)="goBack()" class="back-btn">‚Üê Back to Storages</button>
</div>

<ng-template #loading>
  <p class="loading-text">Loading storage details...</p>
</ng-template>
